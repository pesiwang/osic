<?php
require_once __DIR__ . '/<!--{$object->getName()|name2file}-->.router.php';
class Object_<!--{$object->getName()|name2class}-->{
<!--{foreach from=$object->getFields() key=name item=field}-->
	public $<!--{$name}--> = <!--{if $field->getType() == ObjectField::TYPE_STRING}-->'<!--{$field->getValue()}-->'<!--{else}--><!--{$field->getValue()}--><!--{/if}-->;
<!--{/foreach}-->

<!--{foreach from=$object->getFields()|array_keys item=field}-->
	public function get<!--{$field|ucfirst}-->(){
		return $this-><!--{$field}-->;
	}
	
	public function set<!--{$field|ucfirst}-->($<!--{$field}-->){
		$this-><!--{$field}--> = $<!--{$field}-->;
		return $this;
	}
<!--{/foreach}-->

	static public function get($id){
<!--{if isset($obsolete_router)}-->
		$object = ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::get($id);
		if(!isset($object)){
			$object = ObjectRouterObsolete_<!--{$object->getName()|name2class}-->::get($id);
			if(isset($object))
				ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::set($id, $object);
		}
		return $object;
<!--{else}-->
		return ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::get($id);
<!--{/if}-->
	}
	
	static public function gets(Array $ids){
<!--{if isset($obsolete_router)}-->
		$objects = ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::gets($ids);
		if(count($objects) == count($ids))
			return $objects;
		
		$ids_obsolete = array_diff($ids, array_keys($objects));
		$objects_obsolete = ObjectRouterObsolete_<!--{$object->getName()|name2class}-->::gets($ids_obsolete);
		foreach($objects_obsolete as $id => $object)
			ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::set($id, $object);
		return $objects + $objects_obsolete;
<!--{else}-->
		return ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::gets($ids);
<!--{/if}-->
	}
	
	static public function set($id, Object_<!--{$object->getName()|name2class}--> $object){
		ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::set($id, $object);
	}
	
	static public function del($id){
		ObjectRouterCurrent_<!--{$object->getName()|name2class}-->::del($id);
<!--{if isset($obsolete_router)}-->
		ObjectRouterObsolete_<!--{$object->getName()|name2class}-->::del($id);
<!--{/if}-->
	}
}
